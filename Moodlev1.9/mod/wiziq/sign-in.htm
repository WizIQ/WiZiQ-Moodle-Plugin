<?php
 
 // $Id: mod.html,v 1.5 2006/10/07 12:28:57 gustav_delius Exp $
/**
 * This page defines the form to create or edit an instance of this module
 * It is used from /course/mod.php.  The whole instance is available as $form.
 *
 * @WiZiQ 
 * @version $Id: mod.html,v 1.5 2006/10/07 12:28:57 gustav_delius Exp $
 * @package wizq
 **/

/// First we check that form variables have been initialised
if (!isset($form->name)) {
    $form->name = '';
}
// More similar blocks go here...

$usr = $USER->username;
$email = $USER->email;
//echo $email;
$path=$CFG->wwwroot."/mod/wiziq/forget.php?id=$id&section=$form->section&sesskey=$form->sesskey&add=$form->modulename";
$path1=$CFG->wwwroot."/mod/wiziq/join_now.php?id=$id&section=$form->section&sesskey=$form->sesskey&add=$form->modulename";
//echo $path;
 
 
 
?>


<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>WiZiQ- Sing In</title>

<style>
.m_12b585858{
font-family:Arial, Helvetica, sans-serif;
font-size:12px;
text-decoration:none;
font-weight:bold;
color:#585858;
padding-right:10px;
}

.m_12r585858{
font-family:Arial, Helvetica, sans-serif;
font-size:12px;
text-decoration:none;
font-weight:normal;
color:#000000;
line-height:18px;

}

.m_12rblue{
font-family:Arial, Helvetica, sans-serif;
font-size:12px;
text-decoration: underline;
font-weight:normal;
color:#0F7BBB;
line-height:18px;

}
.m_12rblue:hover{
font-family:Arial, Helvetica, sans-serif;
font-size:12px;
text-decoration: none;
font-weight:normal;
color:#0F7BBB;
line-height:18px;

}
.m_textinput{
font-family:Arial, Helvetica, sans-serif;
font-size:12px;
text-decoration: none;
font-weight:normal;
color:#666666;
height:20px;
border-style:solid;
border-width:1px;
border-color:#CCCCCC;
width:270px;
padding-top:3px;

}

.m_16rblue{
font-family:Arial, Helvetica, sans-serif;
font-size:16px;
text-decoration: none;
font-weight:bold;
color:#0F7BBB;
line-height:18px;
}
.perror{
    border:1px solid #FF0000; 
	font-family:Arial, Helvetica, sans-serif;
	
	font-weight:normal;
	color:#FF0000;
}
.error{
    border:#FF0000 1px; 
	font-family:Arial, Helvetica, sans-serif;
	
	font-weight:normal;
	color:#FF0000;
}
</style>

<script type="text/JavaScript">
<!--
function popitup(url) {
		newwindow=window.open(url,'name','scrollbars=1,height=690,width=900');
	if (window.focus) {newwindow.focus()}
	return false;
}

//-->
</script>
<script type="text/javascript">
//<![CDATA[



function qf_errorHandler(element, _qfMsg) {
  div = element.parentNode;
  
  if (_qfMsg != '') {
    var errorSpan = document.getElementById('id_error_'+element.name);
    if (!errorSpan) {
      errorSpan = document.createElement("span");
      errorSpan.id = 'id_error_'+element.name;
      errorSpan.className = "error";
      element.parentNode.insertBefore(errorSpan, element.parentNode.firstChild);
    }

    while (errorSpan.firstChild) {
      errorSpan.removeChild(errorSpan.firstChild);
    }

    errorSpan.appendChild(document.createTextNode(_qfMsg));
    errorSpan.appendChild(document.createElement("br"));

    if (div.className.substr(div.className.length - 6, 6) != " error"
        && div.className != "error") {
      div.className += " perror";
    }

    return false;
  } else {
    var errorSpan = document.getElementById('id_error_'+element.name);
    if (errorSpan) {
      errorSpan.parentNode.removeChild(errorSpan);
    }

    if (div.className.substr(div.className.length - 6, 6) == " error") {
      div.className = div.className.substr(0, div.className.length - 6);
    } else if (div.className == "error") {
      div.className = "";
    }

    return true;
  }
}
function validate_mod_wiki_mod_form_name(element) {

 var _qfMsg=''; 
value=document.mod.pass.value;

 
  if (value == '') {
    
    _qfMsg ='Enter your password';
 return qf_errorHandler(element, _qfMsg);
  }

  
}


function validate_mod_wiki_mod_form_email(element) {

var _qfMsg=''; 


	var emailID=document.mod.email
	
	if ((emailID.value==null)||(emailID.value=="")){
		_qfMsg ='Enter your Email';

 return qf_errorHandler(element, _qfMsg);
		
		
	}
	if (echeck(emailID.value)==false){
		emailID.value=""
		
		_qfMsg ='Enter a valid email';

 return qf_errorHandler(element, _qfMsg);		
	}
	
}	
 
//value=document.mod.email.value;

 
 

  


function echeck(str) {

		var at="@"
		var dot="."
		var lat=str.indexOf(at)
		var lstr=str.length
		var ldot=str.indexOf(dot)
		if (str.indexOf(at)==-1){
		   //alert("Invalid E-mail ID")
		   return false
		}

		if (str.indexOf(at)==-1 || str.indexOf(at)==0 || str.indexOf(at)==lstr){
		  // alert("Invalid E-mail ID")
		   return false
		}

		if (str.indexOf(dot)==-1 || str.indexOf(dot)==0 || str.indexOf(dot)==lstr){
		    //alert("Invalid E-mail ID")
		    return false
		}

		 if (str.indexOf(at,(lat+1))!=-1){
		    //alert("Invalid E-mail ID")
		    return false
		 }

		 if (str.substring(lat-1,lat)==dot || str.substring(lat+1,lat+2)==dot){
		    //alert("Invalid E-mail ID")
		    return false
		 }

		 if (str.indexOf(dot,(lat+2))==-1){
		    //alert("Invalid E-mail ID")
		    return false
		 }
		
		 if (str.indexOf(" ")!=-1){
		    //alert("Invalid E-mail ID")
		    return false
		 }

 		 return true					
	}

function validate_mod_wiki_mod_form(frm) {

  var ret = true;

  var frm = document.getElementById('mod')
  var first_focus = false;

  ret = validate_mod_wiki_mod_form_email(document.mod.elements['email']);
  if (ret==false ) {
         
  return false;
  }

  ret = validate_mod_wiki_mod_form_name(document.mod.elements['pass']);
  if (ret==false ) {
        
  return false;
  }

  return true;


}
//]]>
</script>
</head>

<body>
<table width="642" border="0" align="center" cellpadding="0" cellspacing="0" style="border:#999999 1px solid;">
  <form name="mod" method="post" action="<?php echo $CFG->wwwroot; ?>/mod/wiziq/login.php">
 <input type="hidden" name="id" value="<?php echo $id;?>" />
    <input type="hidden" name="sesskey" value="<?php  p($form->sesskey); ?>" />

<input type="hidden" name="section"       value="<?php  p($form->section) ?>" />
  <input type="hidden" name="add"       value="<?php p($form->modulename) ?>" />
  <tr>
    <td align="center" valign="top"><img src="images/wiziq-log-m.gif" width="639" height="132" /></td>
  </tr>
  <tr>
    <td align="left" valign="top"></td>
  </tr>
  <tr>
    <td height="395" align="left" valign="top"><table width="100%" border="0" cellspacing="0" cellpadding="0">
      <tr>
        <td height="20" align="left" valign="top"></td>
        </tr>
      <tr>
        <td width="87%" height="362" align="left" valign="top"><table width="95%" border="0" align="center" cellpadding="0" cellspacing="0">
          
          <tr>
            <td height="30" colspan="2" align="left" valign="middle" bgcolor="#F4F4F4" style="padding-left:10px;" class="m_16rblue"><table width="100%" border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td width="13%"><span class="m_16rblue" style="padding-left:10px;">Sign In </span></td>
                <td width="17%" align="right" class="m_12b585858" style="padding-right:10px;">New  User?</td>
                <td width="70%"><a href="<?php echo $path1; ?>" class="m_12rblue">Join Now</a></td>
              </tr>
            </table></td>
            </tr>
          <tr>
            <td height="30" colspan="2" align="right" valign="middle" class="m_12b585858">&nbsp;</td>
            </tr>
          <tr>
            <td height="35" align="right" valign="middle" class="m_12b585858">Email Address:</td>
            <td align="left" valign="middle">
            <div id="id_name"><input name="email"  type="text" id="id_email" onblur="validate_mod_wiki_mod_form_email(this)" onchange="validate_mod_wiki_mod_form_email(this)"/>
            </div>            </td>
          </tr>
          <tr>
            <td width="30%" height="35" align="right" valign="middle" class="m_12b585858">Password:</td>
            <td width="70%" align="left" valign="middle"><div id="id_pass"><input name="pass" onblur="validate_mod_wiki_mod_form_name(this)" onchange="validate_mod_wiki_mod_form_name(this)" id="id_pass" type="password" /></div></td>
          </tr>
          <tr>
            <td height="20px"></td>
            <td><a href="#" onclick="return popitup('http://org.wiziq.com/Forgot_Password.aspx')" class="m_12rblue">Forgot password</a></td>
          </tr>
          <tr>
            <td height="20px"></td>
            <td></td>
          </tr>
          <tr>
            <td></td>
            <td><table width="38%" border="0" cellspacing="0" cellpadding="0">
              <tr>
                <td width="36%" align="left" valign="middle" style="padding-right:10px;"><input name="submit" type="submit"  value="Submit" onclick="return validate_mod_wiki_mod_form(this)"> </td>
              </tr>
            </table></td>
          </tr>
        </table></td>
        </tr>
    </table></td>
  </tr>
  </form>
</table>
</body>
</html>
